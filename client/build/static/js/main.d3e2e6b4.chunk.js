(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{115:function(e,t,a){e.exports=a(188)},120:function(e,t,a){},121:function(e,t,a){},152:function(e,t){},188:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(10),c=a.n(o),i=(a(120),a(121),a(70)),s=a(36),l=a(15),u=a(26),m=a(220),g=a(109),d=a(189),h=a(229),p=a(223),f=a(224),b=a(232),E=a(173),v=a(104),j=a.n(v),y=a(34),O=a.n(y),S=Object(m.a)(function(e){return{root:{padding:e.spacing(3,2),margin:"50px"},background:{backgroundImage:"url('./email-pattern.png')"},guest:{textAlign:"left"},sender:{textAlign:"right"},chatWindow:{display:"flex",flexDirection:"column",width:"100%",height:"400px",padding:"20px",overflowY:"auto"},chatBox:{width:"85%",marginTop:"5px","& label.Mui-focused":{color:"green"},"&.Mui-focused fieldset":{borderColor:"green"}},button:{width:"10%",height:"50px",left:"10px",marginTop:"5px"},rightIcon:{marginLeft:e.spacing(1)},chip:{margin:e.spacing(1)}}}),w=Object(u.b)(function(e){return{auth:e.auth,chat:e.chat}},{getMessages:function(e,t){return function(a){O.a.post("/getmessages",{userId:e,guestId:t}).then(function(e){a({type:"GET_MESSAGES",payload:e.data})}).catch(function(e){console.log(e)})}},sendMessage:function(e){return function(t){O.a.post("/sendmessage",e).then(function(e){}).catch(function(e){console.log(e)})}},getAllMessages:function(e){return function(t){t({type:"GET_MESSAGES",payload:e})}}})(function(e){e.auth.isAuth||e.history.push("/login");var t,a=e.auth.user.id,o=Object(n.useState)(""),c=Object(l.a)(o,2),i=c[0],s=c[1],u=Object(n.useState)(""),m=Object(l.a)(u,2),v=m[0],y=m[1],O=Object(n.useState)(""),w=Object(l.a)(O,2),x=w[0],C=w[1],N=Object(n.useState)(""),k=Object(l.a)(N,2),A=k[0],T=k[1],R=Object(n.useState)([]),_=Object(l.a)(R,2),M=_[0],I=_[1],U=v.split(" ").map(function(e){return e[0]}).join(""),L=x.split(" ").map(function(e){return e[0]}).join(""),G=e.chat.messages.sort(function(e,t){return e.createdAt<t.createdAt?-1:1});Object(n.useEffect)(function(){if(e.location.state){var t=e.location.state,a=t.id,n=t.name;y(n),C(e.auth.user.name),T(a),e.getMessages(e.auth.user.id,a),I(G)}else e.history.push("/")},[]),t||(t=j()("https://mernchat.herokuapp.com/"));var F=S();return r.a.createElement("div",null,r.a.createElement(g.a,{className:F.root},r.a.createElement(d.a,{variant:"h4",component:"h4"},"Chat Application"),r.a.createElement(d.a,{component:"p"},v),r.a.createElement("div",{className:F.background},r.a.createElement("div",{className:F.chatWindow},M.map(function(e){return e.from._id.toString()===A.toString()?r.a.createElement("div",{key:e._id,className:F.guest},r.a.createElement(b.a,{avatar:r.a.createElement(E.a,null,U),label:e.message,className:F.chip,color:"primary"})):r.a.createElement("div",{key:e._id,className:F.sender},r.a.createElement(b.a,{avatar:r.a.createElement(E.a,null,L),label:e.message,className:F.chip,color:"secondary"}))}))),r.a.createElement("div",{className:F.chatBox},r.a.createElement(h.a,{className:F.chatBox,label:"Send message",variant:"outlined",id:"mui-theme-provider-outlined-input",onChange:function(e){return s(e.target.value)},value:i}),r.a.createElement(p.a,{variant:"contained",color:"primary",className:F.button,onClick:function(n){n.preventDefault(),s("");var r={to:A,from:a,message:i};e.sendMessage(r),t.on("chat message",function(t){e.getMessages(e.auth.user.id,e.location.state.id),I(G),e.location.state=""})}},"Send",r.a.createElement(f.a,{className:F.rightIcon},"send")))))}),x=a(225),C=a(226),N=a(61),k=a.n(N),A=function(e){return{type:"SET_CURRENT_USER",payload:e}},T=Object(m.a)(function(e){return{card:{width:"500px",height:"300px",display:"inline-block",margin:"200px"},textField:{marginLeft:e.spacing(1),marginRight:e.spacing(1),width:"100%"},button:{marginTop:e.spacing(5)}}}),R=Object(u.b)(function(e){return{auth:e.auth}},{login:function(e,t){return function(a){O.a.post("/login",e).then(function(e){var n=e.data.token;localStorage.setItem("token",n);var r=k()(n);a(A(r)),t.history.push("/")}).catch(function(e){console.log(e)})}}})(function(e){e.auth.isAuth&&e.history.push("/");var t=Object(n.useState)(""),a=Object(l.a)(t,2),o=a[0],c=a[1],i=Object(n.useState)(""),s=Object(l.a)(i,2),u=s[0],m=s[1],g={username:o,password:u},d=T();return r.a.createElement(x.a,{className:d.card},r.a.createElement(C.a,null,r.a.createElement(h.a,{required:!0,label:"Username",className:d.textField,margin:"normal",onChange:function(e){return c(e.target.value)}}),r.a.createElement(h.a,{required:!0,label:"Password",type:"password",className:d.textField,margin:"normal",onChange:function(e){return m(e.target.value)}}),r.a.createElement(p.a,{variant:"contained",color:"primary",className:d.button,onClick:function(t){e.login(g,e)}},"Login")))}),_=a(231),M=Object(m.a)(function(e){return{card:{width:"500px",height:"400px",display:"inline-block",margin:"200px"},textField:{marginLeft:e.spacing(1),marginRight:e.spacing(1),width:"100%"},button:{marginTop:e.spacing(5)},paper:{position:"absolute",width:400,backgroundColor:e.palette.background.paper,boxShadow:e.shadows[5],padding:e.spacing(4),outline:"none"}}});function I(){return Math.round(20*Math.random())-10}function U(){var e=50+I(),t=50+I();return{top:"".concat(e,"%"),left:"".concat(t,"%"),transform:"translate(-".concat(e,"%, -").concat(t,"%)")}}function L(e){var t=Object(n.useState)(""),a=Object(l.a)(t,2),o=a[0],c=a[1],i=Object(n.useState)(""),s=Object(l.a)(i,2),u=s[0],m=s[1],g=Object(n.useState)(""),f=Object(l.a)(g,2),b=f[0],E=f[1],v=Object(n.useState)(""),j=Object(l.a)(v,2),y=j[0],S=j[1],w=Object(n.useState)(!1),N=Object(l.a)(w,2),k=N[0],A=N[1],T=Object(n.useState)(U),R=Object(l.a)(T,1)[0],I=M();return r.a.createElement(x.a,{className:I.card},r.a.createElement(_.a,{"aria-labelledby":"simple-modal-title","aria-describedby":"simple-modal-description",open:k,onClose:function(){return A(!1)}},r.a.createElement("div",{style:R,className:I.paper},r.a.createElement(d.a,{variant:"h6",id:"modal-title"},y))),r.a.createElement(C.a,null,r.a.createElement(h.a,{required:!0,label:"Name",className:I.textField,margin:"normal",onChange:function(e){return c(e.target.value)}}),r.a.createElement(h.a,{required:!0,label:"Username",className:I.textField,margin:"normal",onChange:function(e){return m(e.target.value)}}),r.a.createElement(h.a,{required:!0,label:"Password",type:"password",className:I.textField,margin:"normal",onChange:function(e){return E(e.target.value)}}),r.a.createElement(p.a,{variant:"contained",color:"primary",className:I.button,onClick:function(t){O.a.post("/register",{name:o,username:u,password:b}).then(function(t){S(t.data.message),A(!0),e.history.push("/login")}).catch(function(e){console.log(e)})}},"Register")))}var G=a(106),F=a(227),q=Object(m.a)(function(e){return{container:{width:"100%",height:"500px",padding:"2rem 0",backgroundImage:"url('./chatList.png')"},root:{alignItems:"center",width:"50%",marginTop:e.spacing(10),marginLeft:"30%",overflowX:"auto"},margin:{margin:e.spacing(2),"&:hover":{backgroundColor:e.palette.primary.light,pointerEvents:"cursor"}}}});function B(e){var t=q(),a=e.className,n=e.message,o=(e.onClose,e.variant),c=Object(G.a)(e,["className","message","onClose","variant"]);return r.a.createElement(F.a,Object.assign({className:[t[o],a].join(" "),"aria-describedby":"client-snackbar",message:r.a.createElement("span",{id:"client-snackbar",className:t.message},n)},c))}var W=Object(u.b)(function(e){return{auth:e.auth}},{getUsers:function(){return function(e){O.a.get("/getusers").then(function(t){e({type:"GET_USERS",payload:t.data})}).catch(function(e){console.log(e)})}},clearChat:function(){return function(e){e({type:"CLEAR_CHAT",payload:[]})}}})(function(e){e.auth.isAuth||e.history.push("/login"),Object(n.useEffect)(function(){e.clearChat(),e.getUsers()},[]);var t=e.auth.users.filter(function(t){return t.name!==e.auth.user.name}),a=q();return r.a.createElement("div",null,r.a.createElement(g.a,{className:a.root},r.a.createElement(d.a,{variant:"h4",component:"h4"},"Available Users"),r.a.createElement("div",{className:a.container},t.map(function(t){return r.a.createElement(B,{key:t.email,variant:"info",className:a.margin,message:t.name,onClick:function(){return e.history.push({pathname:"/chat",state:{id:t._id,name:t.name}})}})}))))}),D=a(230),H=a(228),J=Object(s.d)(Object(u.b)(function(e){return{auth:e.auth}},{logout:function(e){return function(e){localStorage.removeItem("token"),e(A({}))}}})(function(e){var t=r.a.useState(1),a=Object(l.a)(t,2),n=a[0],o=a[1];var c=e.auth.isAuth;return r.a.createElement(g.a,{square:!0},r.a.createElement(D.a,{value:n,indicatorColor:"primary",textColor:"primary",onChange:function(e,t){o(t)}},c?r.a.createElement(H.a,{label:"Dashboard",onClick:function(){return e.history.push("/")}}):null,c?r.a.createElement(H.a,{label:"Logout",onClick:function(){return e.logout()}}):r.a.createElement("div",null,r.a.createElement(H.a,{label:"Login",onClick:function(){return e.history.push("/login")}}),r.a.createElement(H.a,{label:"Register",onClick:function(){return e.history.push("/Register")}}))))}));var P=function(){return r.a.createElement("div",{className:"App"},r.a.createElement(i.a,null,r.a.createElement(J,null),r.a.createElement(s.a,{exact:!0,path:"/",component:W}),r.a.createElement(s.a,{path:"/chat",component:w}),r.a.createElement(s.a,{path:"/login",component:R}),r.a.createElement(s.a,{path:"/register",component:L})))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var X=a(37),Y=a(108),$=a(73),z={isAuth:!1,user:{},users:[]},K=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:z,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_CURRENT_USER":return Object($.a)({},e,{isAuth:!(0===Object.entries(t.payload).length&&t.payload.constructor===Object),user:t.payload});case"GET_USERS":return Object($.a)({},e,{users:Object.assign(e.users,t.payload)});default:return e}},Q={messages:[]},V=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Q,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"GET_MESSAGES":return{messages:Object.assign(e.messages,t.payload)};case"CLEAR_CHAT":return{messages:t.payload};default:return e}},Z=Object(X.c)({auth:K,chat:V}),ee=[Y.a],te=Object(X.e)(Z,{},Object(X.d)(X.a.apply(void 0,ee))),ae=r.a.createElement(u.a,{store:te},r.a.createElement(P,null));if(localStorage.getItem("token")){var ne=localStorage.getItem("token"),re=k()(ne);te.dispatch(A(re))}c.a.render(ae,document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[115,1,2]]]);
//# sourceMappingURL=main.d3e2e6b4.chunk.js.map